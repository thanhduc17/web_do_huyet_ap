<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Face Measurement</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/measure.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <!-- User Info Card -->
      <!-- User Info Card -->
      <div class="user-card">
        <h2>Th√¥ng tin ng∆∞·ªùi d√πng</h2>

        <div class="user-row">
          <div class="user-item">
            <div class="label">H·ªç t√™n</div>
            <div class="value">{{ user_info.get('fullName', '') }}</div>
          </div>
          <div class="user-item">
            <div class="label">Tu·ªïi</div>
            <div class="value">{{ user_info.get('age')|int }}</div>
          </div>
          <div class="user-item">
            <div class="label">Gi·ªõi t√≠nh</div>
            <div class="value">
              {% if user_info.get('gender') == 'male' %}Nam {% elif
              user_info.get('gender') == 'female' %}N·ªØ {% else %}Kh√°c{% endif %}
            </div>
          </div>
          <div class="user-item">
            <div class="label">Chi·ªÅu cao</div>
            <div class="value">{{ user_info.get('height')|int }} cm</div>
          </div>
        </div>

        <div class="user-row">
          <div class="user-item">
            <div class="label">C√¢n n·∫∑ng</div>
            <div class="value">{{ user_info.get('weight')|int }} kg</div>
          </div>
          <div class="user-item">
            <div class="label">BMI</div>
            <div class="value">{{ user_info.get('bmi')|round(1) }}</div>
          </div>
          <div class="user-item">
            <div class="label">Th·ªùi gian ngh·ªâ</div>
            <div class="value">{{ user_info.get('restMin')|int }} ph√∫t</div>
          </div>
        </div>
      </div>

      <!-- Measurement Card -->
      <div class="measurement-card">
        <h2>Face Measurement</h2>
        <p class="status-message" id="statusMessage">üí° M·ªùi b·∫°n ch·ªçn c√°ch ƒëo</p>

        <!-- N√∫t ch·ªçn quay/upload -->
        <div class="options" id="chooseContainer">
          <button id="chooseCamera" class="option-btn">
            <i class="fas fa-video"></i> Quay video
          </button>
          <button id="chooseUpload" class="option-btn">
            <i class="fas fa-upload"></i> Upload video
          </button>
        </div>

        <!-- N√∫t b·∫Øt ƒë·∫ßu ƒëo -->
        <div class="options hidden" id="startBtnContainer">
          <button id="startMeasure" class="option-btn">B·∫Øt ƒë·∫ßu ƒëo</button>
        </div>

        <!-- Webcam -->
        <div id="cameraSection" class="hidden">
          <img id="webcamStream" alt="Webcam stream" />
        </div>

        <!-- Upload -->
        <div id="uploadSection" class="hidden">
          <form id="uploadForm" enctype="multipart/form-data">
            <input
              type="file"
              id="videoInput"
              name="video"
              accept="video/*"
              required
            />
            <video id="previewVideo" class="hidden" controls></video>
            <button type="submit" class="option-btn">Upload & X·ª≠ l√Ω</button>
          </form>
        </div>

        <!-- K·∫øt qu·∫£ ƒëo SBP/DBP v·ªõi gauge -->
        <!-- K·∫øt qu·∫£ ƒëo SBP/DBP v·ªõi gauge -->
        <div id="resultSection" class="hidden small-result">
          <h3 class="result-title">K·∫øt qu·∫£ ƒëo</h3>
          <div class="gauge-container">
            <div class="gauge-card">
              <h4>SBP</h4>
              <canvas id="sbpGauge"></canvas>
              <p><span id="sbp"></span> mmHg</p>
            </div>
            <div class="gauge-card">
              <h4>DBP</h4>
              <canvas id="dbpGauge"></canvas>
              <p><span id="dbp"></span> mmHg</p>
            </div>
          </div>
          <button id="restart" class="option-btn">ƒêo l·∫°i</button>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', filename='js/measure.js') }}"></script>
  </body>
</html>
